(()=>{let e;function o(e,o,r,t){Object.defineProperty(e,o,{get:r,set:t,enumerable:!0,configurable:!0})}var r,t,i,n,a,d,l={};o(l,"ErrorCode",()=>a),o(l,"errorDict",()=>M),o(l,"deepCopy",()=>j),o(l,"triggerPmac",()=>ec),o(l,"initPubxGlobals",()=>eO),o(l,"arePubxFloorsSkipped",()=>eg),o(l,"arePubxFloorsSet",()=>eb),o(l,"getFloorMvValue",()=>em),o(l,"getPubxOptimizedValue",()=>eR),o(l,"getPubxSplitValue",()=>eE),o(l,"setSplitKeyGlobal",()=>eU),o(l,"setFloorsAndMvInGlobal",()=>ey);let _="PubxFloorProvider";(r=n||(n={})).WIN="WIN",r.FLOORED="FLOORED",r.NOBIDS="NOBIDS";let s=e=>({provider:"pubxai",options:{samplingRate:e.samplingRate,pubxId:e.pubxId}}),u=e=>{let o={floors:{enforcement:{floorDeals:!0},auctionDelay:e.auctionDelay,endpoint:{url:e.floorFetchUrl},data:{floorProvider:_,modelVersion:e.modelVersion,currency:e.currency,schema:{fields:e.schema},values:e.defaultValues}}};return e.floorMin&&(o.floors.floorMin=e.floorMin),o},p=(e,o,r)=>{e&&o.pbNamespace.que.push(function(){let{debug:e,error:t,remotePageError:i}=window.__pubx__.logger;if(!o.pbNamespace.installedModules.includes("priceFloors")){t("priceFloors module is not installed"),i({code:l.ErrorCode.PRICE_FLOORS_NOT_FOUND});return}let n=o.pbNamespace.getConfig("floors");n&&n.data&&n.data.floorProvider!==_&&(t("Non-pubx floor provider present",n),i({code:l.ErrorCode.NON_PUBX_FLOORS_FOUND,payload:{existingFloors:n}}));let a=r(o);o.pbNamespace.setConfig(a),e("Setting Floors Config",(0,l.deepCopy)(a))})},c=(e,o)=>{let r=void 0!==e.adserverTargeting&&void 0!==e.adserverTargeting[o]&&!isNaN(e.adserverTargeting[o])&&parseFloat(e.adserverTargeting[o])>0;return r},O=(e,o)=>e.filter(e=>e.adUnitCode===o),f=(e,o)=>e.filter(e=>e.adUnitCode===o),g=(e,o)=>e.flatMap(e=>e.bids).filter(e=>e.adUnitCode===o),b=(e,o,r)=>0===e.length&&0===o.length?n.NOBIDS:e.some(e=>c(e,r))?n.WIN:n.FLOORED,N=(e,o,r,t,i,n)=>{if(o===r)return e;if("number"!=typeof e||"string"!=typeof o||"string"!=typeof r)return n({code:l.ErrorCode.CURRENCY_INVALID_INPUT,adUnitCode:i,payload:{value:e,fromCurrency:o,toCurrency:r}}),window.__pubx__.logger.error("Invalid input types for currency conversion",{value:e,fromCurrency:o,toCurrency:r},"Skipping conversion."),e;let a=t.pbNamespace.getConfig("currency");if(a){let t=a.rates||a.defaultRates;if(t&&t[o]&&t[o][r]){let i=t[o][r];return e*i}}return n({code:l.ErrorCode.CURRENCY_RATES_NOT_FOUND,adUnitCode:i,payload:{fromCurrency:o,toCurrency:r}}),window.__pubx__.logger.error("Conversion rates for these currencies are not available",{fromCurrency:o,toCurrency:r},"Skipping conversion."),e},m=(e,o)=>[...e,...o],R=e=>{if(void 0!==e)return{floorValue:e.floorValue,floorRule:e.floorRule,floorCurrency:e.floorCurrency}},E=(e,o,r,t,i,a,d)=>{let _,s,u,p,O,f;let{remoteAucError:g,remoteAucEvent:b}=d,{hbPbKey:E}=a;switch(i){case n.WIN:let F=o.filter(e=>c(e,E)).sort((e,o)=>parseFloat(o.adserverTargeting[E])-parseFloat(e.adserverTargeting[E]))[0];_=parseFloat(F.adserverTargeting[E]),s=F.currency,u=F.floorData,p=F.adserverTargeting;break;case n.FLOORED:let U=m(r,o),y=U.sort((o,r)=>N(r.originalCpm,r.originalCurrency,a.currency,a,e.code,g)-N(o.originalCpm,o.originalCurrency,a.currency,a,e.code,g))[0];_=y.originalCpm,s=y.originalCurrency,u=y.floorData,p=y.adserverTargeting;break;case n.NOBIDS:if(s=a.currency,(0,l.arePubxFloorsSkipped)(e)){_=.01;break}void 0!==e.sizes?O=e.sizes:(g({code:l.ErrorCode.ADUNIT_SIZES_NOT_FOUND,adUnitCode:e.code}),window.__pubx__.logger.error("sizes in adUnit is undefined",e),O=["*"]);let C=t.flatMap(o=>O.map(r=>{if("function"==typeof o.getFloor){let t=o.getFloor({size:r,mediaType:"banner"});if(void 0!==t&&void 0!==t.floor)return t.floor;window.__pubx__.logger.error("calc nbids - bidderRequests.bid.getFloor().floor is undefined",e.code)}else window.__pubx__.logger.error("calc nbids - bidderRequests.bid.getFloor doesn't exist",e.code)})).filter(e=>void 0!==e);0!==C.length?f=C.reduce((e,o)=>e+o,0)/C.length:(0===t.length||(g({code:l.ErrorCode.GET_FLOOR_NOT_FOUND,adUnitCode:e.code}),window.__pubx__.logger.error("calc nbids - None of bidderRequests.bids.getFloor() is defined",e.code)),void 0!==a.defaultValues["*|banner"]?f=a.defaultValues["*|banner"]:(g({code:l.ErrorCode.TAG_DEFAULT_VALUES_NOT_FOUND,adUnitCode:e.code}),window.__pubx__.logger.error("defaultValues of *|banner in config is undefined",e.code),f=.01)),_=f}return b({type:"pbBid",data:{adUnitCode:e.code,status:i,bidCurrency:s,bidValue:parseFloat(_.toFixed(4)),pubCurrency:a.currency,floorData:R(u),adserverTargeting:p}}),i===n.FLOORED&&(_=N(_,s,a.currency,a,e.code,g)),parseFloat(_.toFixed(4))},F=e=>{let o=e.flatMap(e=>e.bids.map(({floorData:e})=>{if(e&&e.floorProvider===_&&e.modelVersion)return e.modelVersion})).filter(e=>void 0!==e)[0];return o},U=e=>{let o=e.includes("_AB_")?e.split("_AB_")[1].split("_")[0]:void 0;return o},y=(e,o,r)=>{switch(r){case n.WIN:return e.includes("_dwt_")?parseFloat(e.split("_dwt_")[1].split("_")[0]):o.winBidMultiplier;case n.FLOORED:return e.includes("_dt_")?parseFloat(e.split("_dt_")[1].split("_")[0]):o.flooredBidMultiplier;case n.NOBIDS:return e.includes("_dnt_")?parseFloat(e.split("_dnt_")[1].split("_")[0]):o.noBidMultiplier}},C=(e,o,r)=>{let{error:t}=window.__pubx__.logger;if(e.includes("_fm_"))return parseFloat(e.split("_fm_")[1].split("_")[0]);if(r({code:l.ErrorCode.PMAC_FLOOR_MULTIPLIER_NOT_FOUND,payload:{modelVersion:e}}),t(l.errorDict[l.ErrorCode.PMAC_FLOOR_MULTIPLIER_NOT_FOUND].message,{modelVersion:e}),!o.pmacFloorMultiplier)throw r({code:l.ErrorCode.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG}),t(l.errorDict[l.ErrorCode.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG].message,{modelVersion:e}),Error("pmacFloorMultiplier is not set in config");return o.pmacFloorMultiplier},I=(e,o,r)=>{let t=void 0!==e.mediaTypes.banner,i=e.bids.some(e=>!!e.bidder),n=(0,l.arePubxFloorsSet)(e);if(!o&&n)throw r({code:l.ErrorCode.PUBX_OFF_FLOORS_FOUND,adUnitCode:e.code}),Error("pubxLoaded is false but has floorData for adUnitCode "+e.code);return t&&i&&(!o&&!n||o&&n)},T=e=>e?e.filter(e=>!!e.originalCpm):[],v=(e,o,r,t,i)=>{let{remoteAucError:n}=i;return o.adUnits.filter(o=>I(o,e,n)&&(0,l.arePubxFloorsSet)(o)).map(e=>{let a=O(o.bidsReceived,e.code),d=f(T(o.bidsRejected),e.code),_=g(o.bidderRequests,e.code),s=b(a,d,t.hbPbKey);if(void 0===r)throw n({code:l.ErrorCode.MODEL_VERSION_NOT_FOUND_READ,adUnitCode:e.code}),Error("floorModelVersion is undefined but adUnit.bids is not");let u=E(e,a,d,_,s,t,i);try{(0,l.triggerPmac)(o.auctionId,e.code,u,s,t,C(r,t,n),i)}catch(e){window.__pubx__.logger.error("Error in Pmac",e)}e.code;let p=parseFloat((u*y(r,t,s)).toFixed(4));return(0,l.arePubxFloorsSkipped)(e)?void 0:{adUnitCode:e.code,floorValue:p,status:s}}).filter(e=>void 0!==e)},w=(e,o)=>{let r=googletag.pubads().getSlots(),t=[];return e.forEach(e=>{let i=r.find(o=>o.getAdUnitPath()===e||o.getSlotElementId()===e);void 0===i?(window.__pubx__.logger.error("GPT Slot not found for adUnitCode",e),o({code:l.ErrorCode.GPT_SLOT_NOT_FOUND,adUnitCode:e})):t.push({adUnitCode:e,slot:i})}),t},A=(e,o)=>{if(0===e)return o[0];let r=o.find(o=>{let r=Object.keys(o)[0],[t,i]=o[r];return e>t&&e<=i});return r},x=(e,o,r)=>{let t=A(e.floorValue,o.gamBuckets);if(void 0===t)throw r({code:l.ErrorCode.GAM_BUCKET_NOT_FOUND,adUnitCode:e.adUnitCode,payload:{floorWithStatus:e}}),Error("GAM Bucket not found for floorValue "+JSON.stringify(e));let i=Object.keys(t)[0],a=e.status===n.WIN?"_w":e.status===n.FLOORED?"_f":"_n";return i.split("_n")[0]+a};var D=function(e,o,r,t){return new(r||(r=Promise))(function(i,n){function a(e){try{l(t.next(e))}catch(e){n(e)}}function d(e){try{l(t.throw(e))}catch(e){n(e)}}function l(e){var o;e.done?i(e.value):((o=e.value)instanceof r?o:new r(function(e){e(o)})).then(a,d)}l((t=t.apply(e,o||[])).next())})},S=function(e,o){var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&0>o.indexOf(t)&&(r[t]=e[t]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,t=Object.getOwnPropertySymbols(e);i<t.length;i++)0>o.indexOf(t[i])&&Object.prototype.propertyIsEnumerable.call(e,t[i])&&(r[t[i]]=e[t[i]]);return r};let L="https://analytics.pbxai.com",P=L+"/errors",h=L+"/events";(t=a||(a={})).GPT_SLOT_NOT_FOUND="GPT_SLOT_NOT_FOUND",t.GAM_BUCKET_NOT_FOUND="GAM_BUCKET_NOT_FOUND",t.CALC_FLOOR_NOT_FOUND="CALC_FLOOR_NOT_FOUND",t.MODEL_VERSION_NOT_FOUND_WRITE="MODEL_VERSION_NOT_FOUND_WRITE",t.IMPROVEMEDIA_API_NOT_FOUND="IMPROVEMEDIA_API_NOT_FOUND",t.INVESTING_FILTER_NOT_FOUND="INVESTING_FILTER_NOT_FOUND",t.PUBX_AA_NOT_FOUND="PUBX_AA_NOT_FOUND",t.PRICE_FLOORS_NOT_FOUND="PRICE_FLOORS_NOT_FOUND",t.NON_PUBX_FLOORS_FOUND="NON_PUBX_FLOORS_FOUND",t.CURRENCY_INVALID_INPUT="CURRENCY_INVALID_INPUT",t.CURRENCY_RATES_NOT_FOUND="CURRENCY_RATES_NOT_FOUND",t.ADUNIT_SIZES_NOT_FOUND="ADUNIT_SIZES_NOT_FOUND",t.GET_FLOOR_NOT_FOUND="GET_FLOOR_NOT_FOUND",t.TAG_DEFAULT_VALUES_NOT_FOUND="TAG_DEFAULT_VALUES_NOT_FOUND",t.PUBX_OFF_FLOORS_FOUND="PUBX_OFF_FLOORS_FOUND",t.MODEL_VERSION_NOT_FOUND_READ="MODEL_VERSION_NOT_FOUND_READ",t.PMAC_FLOOR_MULTIPLIER_NOT_FOUND="PMAC_FLOOR_MULTIPLIER_NOT_FOUND",t.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG="PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG",t.INVALID_SCHEMA_FIELDS_FLOORS_RESPONSE="INVALID_SCHEMA_FIELDS_FLOORS_RESPONSE",t.MISSING_ADUNIT_FLOOR_RESPONSE="MISSING_ADUNIT_FLOOR_RESPONSE",t.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE="PMAC_FLOOR_RESPONSE_NOT_AVAILABLE",t.UNCAUGHT_ERROR="UNCAUGHT_ERROR",(i=d||(d={})).INFO="INFO",i.WARNING="WARNING",i.ERROR="ERROR",i.FATAL="FATAL";let M={[a.GPT_SLOT_NOT_FOUND]:{message:"GPT Slot not found",severity:d.WARNING},[a.GAM_BUCKET_NOT_FOUND]:{message:"GAM Bucket not found",severity:d.WARNING},[a.CALC_FLOOR_NOT_FOUND]:{message:"floorWithStatus not found",severity:d.FATAL},[a.MODEL_VERSION_NOT_FOUND_WRITE]:{message:"floorModelVersion is undefined but floorsWithStatus is not",severity:d.FATAL},[a.IMPROVEMEDIA_API_NOT_FOUND]:{message:"lwhbim.adServerKeywordsAdUnit is not defined",severity:d.ERROR},[a.INVESTING_FILTER_NOT_FOUND]:{message:"window._imhb_auctions is not defined",severity:d.ERROR},[a.PUBX_AA_NOT_FOUND]:{message:"pubxaiAnalyticsAdapter module is not installed",severity:d.WARNING},[a.PRICE_FLOORS_NOT_FOUND]:{message:"priceFloors module is not installed",severity:d.WARNING},[a.NON_PUBX_FLOORS_FOUND]:{message:"Non-pubx floor provider present",severity:d.WARNING},[a.CURRENCY_INVALID_INPUT]:{message:"Invalid input types for currency conversion",severity:d.WARNING},[a.CURRENCY_RATES_NOT_FOUND]:{message:"Conversion rates are not available",severity:d.WARNING},[a.ADUNIT_SIZES_NOT_FOUND]:{message:"sizes in adUnit is undefined",severity:d.WARNING},[a.GET_FLOOR_NOT_FOUND]:{message:"calc nbids - None of bidderRequests.bids.getFloor() is defined",severity:d.WARNING},[a.TAG_DEFAULT_VALUES_NOT_FOUND]:{message:"defaultValues of *|banner in config is undefined",severity:d.ERROR},[a.PUBX_OFF_FLOORS_FOUND]:{message:"pubxLoaded is false but has floorData",severity:d.FATAL},[a.MODEL_VERSION_NOT_FOUND_READ]:{message:"floorModelVersion is undefined but adUnit.bids is not",severity:d.FATAL},[a.PMAC_FLOOR_MULTIPLIER_NOT_FOUND]:{message:"PMAC floor multiplier not found in floors-response",severity:d.ERROR},[a.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG]:{message:"PMAC floor multiplier not found in config",severity:d.ERROR},[a.INVALID_SCHEMA_FIELDS_FLOORS_RESPONSE]:{message:"Invalid schema fields in floor rules response, expected only ['gptSlot']",severity:d.ERROR},[a.MISSING_ADUNIT_FLOOR_RESPONSE]:{message:"adUnitCode not found in floor rules response",severity:d.ERROR},[a.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE]:{message:"Floors Reponse not available for pmac",severity:d.WARNING},[a.UNCAUGHT_ERROR]:{message:"Uncaught Error",severity:d.ERROR}},V=e=>{let{__pubx__:{variant:o,version:r}}=window;return{variant:o,version:r,loadTime:window.__loadTime__,pbVersion:e.pbNamespace.version}},G=e=>({userAgent:navigator.userAgent,host:window.location.host,path:window.location.pathname,pageId:e,doNotTrack:navigator.doNotTrack}),B=(e,o)=>e.pbNamespace.getEvents().filter(e=>"auctionEnd"===e.eventType).findIndex(e=>e.args.auctionId===o),k=e=>e.pbNamespace.getEvents().filter(e=>"auctionInit"===e.eventType).length,j=e=>JSON.parse(JSON.stringify(e)),W=e=>{let{code:o,adUnitCode:r,payload:t}=e,{message:i,severity:n}=M[o];return{code:o,severity:n,message:i,adUnitCode:r,payload:t}},K=(e,o,r,t)=>{let i=j(o);if(e.adUnitCode){let{adUnits:o,bidderRequests:r,bidsReceived:t,bidsRejected:n}=i;i=Object.assign(Object.assign({},i),{adUnits:o.filter(o=>o.code===e.adUnitCode),bidderRequests:r.map(o=>Object.assign(Object.assign({},o),{bids:o.bids.filter(o=>o.adUnitCode===e.adUnitCode)})),bidsReceived:t.filter(o=>o.adUnitCode===e.adUnitCode),bidsRejected:n?n.filter(o=>o.adUnitCode===e.adUnitCode):void 0})}let{auctionId:n,adUnits:a,bidderRequests:d,bidsReceived:l,bidsRejected:_}=i,s={adUnits:a.map(({code:e,sizes:o,bids:r,mediaTypes:t})=>({code:e,mediaTypes:Object.keys(t)})),bidderRequestsCount:d.length,bidsReceived:l.map(({adUnitCode:e,adserverTargeting:o,cpm:r,currency:t,originalCpm:i,originalCurrency:n,floorData:a})=>({adUnitCode:e,adserverTargeting:o?{hb_pb:o.hb_pb}:void 0,cpm:r,currency:t,originalCpm:i,originalCurrency:n,floorData:a?{floorValue:a.floorValue}:void 0})),bidsRejected:_?_.map(({adUnitCode:e,adserverTargeting:o,cpm:r,currency:t,originalCpm:i,originalCurrency:n,floorData:a})=>({adUnitCode:e,adserverTargeting:o?{hb_pb:o.hb_pb}:void 0,cpm:r,currency:t,originalCpm:i,originalCurrency:n,floorData:a?{floorValue:a.floorValue}:void 0})):void 0};return Object.assign({previousAuctionCount:B(r,n),auctionId:n,auctionInfo:s,modelVersion:F(d)},q(e,r,t))},q=(e,o,r)=>({isPubxEnabled:window.__pubxLoaded__,pubxId:o.pubxId,tagInfo:V(o),pageInfo:G(r),errorData:W(e),timesince:Date.now()-window.__loadTimestamp__,timestamp:Date.now()}),z=e=>{let o=e.pbNamespace.getConfig("floors");return o&&o.data&&o.data.floorProvider?o.data.floorProvider:void 0},X=(e,o,r,t)=>{let{auctionId:i,adUnits:n,bidsReceived:a,bidsRejected:d,bidderRequests:l}=e,_={adUnitCount:n.length,bidCount:a.length+(d?d.length:0),bidders:[...new Set(l.map(({bidderCode:e})=>e))]};return{isPubxEnabled:window.__pubxLoaded__,pubxId:o.pubxId,loadedBeforePb:window.__loadedBeforePb__,tagInfo:V(o),floorProvider:z(o),pageInfo:G(t),missedAuctionCount:r,timesince:Date.now()-window.__loadTimestamp__,timestamp:Date.now(),previousAuctionCount:B(o,i),auctionId:i,auctionInfo:_,modelVersion:F(l),pbBidData:[],gamTargetingData:[]}},H=e=>{let{severity:o}=M[e.code];return!1},Y=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let o=16*Math.random()|0;return("x"===e?o:3&o|8).toString(16)}),J=e=>{let o=[],r=[],t=[],i=k(e),n=Y(),a=1/e.samplingRate>Math.random();window.__pubxLogsEnabled__=a;let d=(e,o)=>{if(0===e.length)return;JSON.parse(JSON.stringify(e));let r=new Blob([JSON.stringify(e)],{type:"application/json"});navigator.sendBeacon(o,r),e.splice(0)},l=e=>{if(0===e.length)return 0;let o=new Blob([JSON.stringify(e)]);return o.size},_=()=>!!navigator.sendBeacon&&!!document.visibilityState;_()&&document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(d(o,P),d(r,P),d(t,h))});let s=window.location.search,u=new URLSearchParams(s);return{debug:(e,...o)=>{u.has("pubx_debug")&&console.info("%cPubx.ai","background-color: #fc6203; color: white; border-radius: 3px; padding: 1px 4px","INFO:",e,...o)},error:(...e)=>{u.has("pubx_debug")&&console.error("%cPubx.ai","background-color: #fc6203; color: white; border-radius: 3px; padding: 1px 4px","ERROR:",...e)},makeRemoteAucError:r=>{let t=j(r),i=(o,r)=>{r.push(K(o,t,e,n)),j(r)};return e=>{if(_()&&(a||H(e))){let r=j(o);i(e,r),l(r)>65536?(d(o,P),i(e,o)):o=r}}},remotePageError:o=>{if(_()&&(a||H(o))){let t=(o,r)=>{r.push(q(o,e,n))},i=j(r);t(o,i),l(i)>65536?(d(r,P),t(o,r)):r=i}},makeRemoteAucEvent:o=>{let r=j(o),s=(o,t)=>{let a=t.find(e=>e.auctionId===r.auctionId);if(void 0===a&&(a=X(r,e,i,n),t.push(a)),"pbBid"===o.type)a.pbBidData.push(o.data);else if("gamTargeting"===o.type){let e=o.data,r=a.gamTargetingData.find(o=>o.adUnitCode===e.adUnitCode);void 0===r?a.gamTargetingData.push(e):Object.assign(r,e)}j(t)};return e=>{if(_()&&a){let o=j(t);s(e,o),l(o)>65536?(d(t,h),s(e,t)):t=o}}}}},Z=()=>{window.__pubx__.logger.debug("version:","pubx_"+window.__pubx__.variant+"_"+window.__pubx__.version)},Q=()=>{window.__loadTime__=window.__loadTimestamp__?Date.now()-window.__loadTimestamp__:-1,window.__loadTimestamp__=Date.now()},$=(e,o)=>{let r=u(o).floors,{auctionDelay:t,endpoint:i,data:n}=r,a=S(r,["auctionDelay","endpoint","data"]);window.__nextfloorsConfig__={floors:Object.assign(Object.assign({},a),{data:e})}},ee=e=>window.__pmacCpmHistory__[e],eo=e=>{let o=ee(e);return o?o.history:[]},er=(e,o,r,t)=>{let{debug:i}=window.__pubx__.logger,{__pmacCpmHistory__:n}=window;void 0===n[o]&&(n[o]={history:[],decayRate:void 0});let a={auctionId:e,cpm:r,adUnitStatus:t};eo(o).push(a),i("Update Pmac history",o,a)},et=(e,o,r)=>Math.log(o/(e=0===e?.01:e))/r,ei=(e,o,r)=>(e=0===e?.01:e)*Math.exp(o*r),en=e=>{let{debug:o}=window.__pubx__.logger,r=ee(e),{history:t}=r,[i,n,a]=[t[0].cpm,t[t.length-1].cpm,t.length-1];r.decayRate=et(i,n,a),o("Update decay rate",e,r.decayRate)},ea=e=>{let o=eo(e);if(0===o.length)return!1;if(1===o.length)return!0;let r=o.slice(0,-1).map(e=>e.cpm).reduce((e,o)=>Math.min(e,o)),t=o[o.length-1].cpm;return t<r},ed=(e,o)=>{let{remoteAucError:r}=o,{__pmacCpmHistory__:t}=window,i=Object.keys(t),n=w(i,r);n.forEach(({adUnitCode:r,slot:t})=>{ea(r)&&e_(r,t,eu(r,e),o)})},el=(e,o)=>{let r=Object.keys(o),t=r.find(o=>[e.getAdUnitPath()+"|banner|*",e.getSlotElementId()+"|banner|*"].includes(o));return t},e_=(e,o,r,t)=>{let{remoteAucError:i}=t,{error:n}=window.__pubx__.logger,{__nextfloorsConfig__:d}=window;if(void 0===d)throw Error("__nextfloorsConfig__ undefined. Skip updating adUnit floors config");let{floors:{data:{values:l}}}=d,_=el(o,l);if(void 0===_){i({code:a.MISSING_ADUNIT_FLOOR_RESPONSE,adUnitCode:e}),n(M[a.MISSING_ADUNIT_FLOOR_RESPONSE].message,{adUnitCode:e});return}l[_]=r},es=e=>eo(e).length<=1,eu=(e,o)=>{let{decayRate:r,history:t}=ee(e),[i,a,d]=[t[0].cpm,t.length,t[t.length-1]];if(es(e)||d.adUnitStatus===n.NOBIDS)return.01;let l=ei(i,r,a),_=l*o;return _<.01?.01:parseFloat(_.toFixed(4))},ep=(e,o)=>D(void 0,void 0,void 0,function*(){let{debug:o}=window.__pubx__.logger,r=yield fetch(e.floorFetchUrl),t=yield r.json();o("Received floor rules",t),$(t,e)}),ec=(e=null,(o,r,t,i,n,d,l)=>D(void 0,void 0,void 0,function*(){let{remoteAucError:_}=l,{error:s}=window.__pubx__.logger;null===e&&(e=ep(n,l)),yield e,er(o,r,t,i),es(r)||en(r);let{__nextfloorsConfig__:u,__pubxLoaded__:c}=window;if(void 0===u)throw _({code:a.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE,adUnitCode:r}),s(M[a.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE].message,{adUnitCode:r}),Error("__nextfloorsConfig__ undefined. Skip updating floors config");googletag.cmd.push(()=>{ed(d,l),p(c,n,e=>u)})})),eO=(e,o)=>{window.__pubxFloors__={},window.__pubxLoaded__=ef(e.splitRate),window.__loadedBeforePb__=void 0===e.pbNamespace.version,window.__pmacCpmHistory__={},Q(),e.pbNamespace.que.push(function(){window.__pubx__={variant:o,version:"1706783711242",logger:J(e)},Z()})},ef=e=>void 0!==window.__pubxLoaded__?window.__pubxLoaded__:e>100*Math.random(),eg=e=>e.bids.some(({floorData:e})=>e&&e.floorProvider===_&&e.skipped),eb=e=>e.bids.some(({floorData:e})=>e&&e.floorProvider===_&&e.modelVersion),eN=(e,o,r)=>{if("object"!=typeof e||0===o.length){window.__pubx__.logger.error("setObjectValueFromKeyPath: invalid arguments",{object:e,keyPath:o,value:r});return}let t=o.length-1;for(let r=0;r<t;++r){let t=o[r];t in e||(e[t]={}),e=e[t]}e[o[t]]=r},em=(e,o)=>e+"-"+o,eR=(e,o)=>{let r=eg(e);return r?o.pubxOptimizedOffValue:o.pubxOptimizedOnValue},eE=(e,o)=>{let r=eb(e);return r?o.pubxSplitOnValue:o.pubxSplitOffValue},eF=(e,o,r,t,i)=>{let{remoteAucEvent:n}=i;eN(window.__pubxFloors__,[e,o,r],t),window.__pubx__.logger.debug("Setting KVs in Global",{auctionId:e,adUnitCode:o,key:r,value:t}),n({type:"gamTargeting",data:{adUnitCode:o,[r]:t}})},eU=(e,o,r,t)=>{let{remoteAucError:i,remoteAucEvent:n}=t,{auctionId:a,adUnits:d}=r;d.filter(o=>I(o,e,i)).forEach(e=>{let r=eE(e,o);if(eF(a,e.code,o.pubxSplitKey,r,t),r===o.pubxSplitOnValue){let r=eR(e,o);eF(a,e.code,o.pubxOptimizedKey,r,t)}})},ey=(e,o,r,t,i)=>{let{remoteAucError:n}=i;e.forEach(e=>{let{adUnitCode:d}=e,l=x(e,t,n);if(eF(r,d,t.pubxFloorKey,l,i),void 0===o)throw n({code:a.MODEL_VERSION_NOT_FOUND_WRITE,adUnitCode:d,payload:{floorWithStatus:e}}),Error("floorModelVersion is undefined but floorsWithStatus is not");let _=U(o);if(_){eF(r,d,t.pubxMvKey,_,i);let e=em(l,_);eF(r,d,t.pubxFloorMvKey,e,i)}})},eC=(()=>{window.googletag=window.googletag||{};window.googletag.cmd=window.googletag.cmd||[];window.pbjs=window.pbjs||{};window.pbjs.que=window.pbjs.que||[];return{splitRate:95,samplingRate:10,pbNamespace:pbjs,currency:"EUR",modelVersion:"cb_AB_z_dt_0.75_dwt_1.0_dnt_0.1_fm_0.5",auctionDelay:100,pubxId:"315b44bc-10e5-45a8-8f58-064d6e7317c0",schema:['gptSlot','mediaType'],defaultValues:{'*|banner':0.01},floorFetchUrl:"https://floor.pbxai.com/?pubxId=315b44bc-10e5-45a8-8f58-064d6e7317c0&page="+window.top.location.href,floorMin:null,hbPbKey:"hb_pb",pubxSplitKey:"pubx-a",pubxSplitOnValue:"on",pubxSplitOffValue:"off",pubxOptimizedKey:"pubx-op",pubxOptimizedOnValue:"on",pubxOptimizedOffValue:"off",pubxMvKey:"pubx-m_v",pubxFloorKey:"pubx-floor",pubxFloorMvKey:"pubx-floor-mv",flooredBidMultiplier:0.75,noBidMultiplier:0.1,winBidMultiplier:1.0,pmacFloorMultiplier:0.5,gamBuckets:[{'pbx_a0d_n':[0,0.03]},{'pbx_a1d_n':[0.03,0.06]},{'pbx_a2d_n':[0.06,0.09]},{'pbx_a3d_n':[0.09,0.12]},{'pbx_a4d_n':[0.12,0.15]},{'pbx_b0d_n':[0.15,0.2]},{'pbx_b1d_n':[0.2,0.25]},{'pbx_b2d_n':[0.25,0.3]},{'pbx_b3d_n':[0.3,0.35]},{'pbx_b4d_n':[0.35,0.4]},{'pbx_b5d_n':[0.4,0.45]},{'pbx_b6d_n':[0.45,0.5]},{'pbx_b7d_n':[0.5,0.55]},{'pbx_b8d_n':[0.55,0.6]},{'pbx_b9d_n':[0.6,0.65]},{'pbx_b10d_n':[0.65,0.7]},{'pbx_b11d_n':[0.7,0.75]},{'pbx_b12d_n':[0.75,0.8]},{'pbx_b13d_n':[0.8,0.85]},{'pbx_b14d_n':[0.85,0.9]},{'pbx_b15d_n':[0.9,0.95]},{'pbx_b16d_n':[0.95,1]},{'pbx_c0d_n':[1,1.1]},{'pbx_c1d_n':[1.1,1.2]},{'pbx_c2d_n':[1.2,1.3]},{'pbx_c3d_n':[1.3,1.4]},{'pbx_c4d_n':[1.4,1.5]},{'pbx_c5d_n':[1.5,1.6]},{'pbx_c6d_n':[1.6,1.7]},{'pbx_c7d_n':[1.7,1.8]},{'pbx_c8d_n':[1.8,1.9]},{'pbx_c9d_n':[1.9,2]},{'pbx_d0d_n':[2,2.25]},{'pbx_d1d_n':[2.25,2.5]},{'pbx_d2d_n':[2.5,2.75]},{'pbx_d3d_n':[2.75,3]},{'pbx_d4d_n':[3,3.25]},{'pbx_d5d_n':[3.25,3.5]},{'pbx_d6d_n':[3.5,3.75]},{'pbx_d7d_n':[3.75,4]},{'pbx_d8d_n':[4,4.25]},{'pbx_d9d_n':[4.25,4.5]},{'pbx_d10d_n':[4.5,4.75]},{'pbx_d11d_n':[4.75,5]},{'pbx_d12d_n':[5,111111]}]};})();(0,l.initPubxGlobals)(eC,"pb_gam_global_kvs");let eI=window.__pubxLoaded__;(e=>{e.pbNamespace.que.push(function(){let{debug:o,error:r,remotePageError:t}=window.__pubx__.logger;if(!e.pbNamespace.installedModules.includes("pubxaiAnalyticsAdapter")){r("pubxaiAnalyticsAdapter module is not installed"),t({code:l.ErrorCode.PUBX_AA_NOT_FOUND});return}{let r=s(e);e.pbNamespace.enableAnalytics(r),o("Enabling Analytics",r)}})})(eC),p(eI,eC,u),((e,o,r,t,i)=>{o.pbNamespace.que.push(function(){o.pbNamespace.onEvent("auctionEnd",n=>{try{let{makeRemoteAucError:a,makeRemoteAucEvent:d,error:_}=window.__pubx__.logger,s={remoteAucError:a(n),remoteAucEvent:d(n)};try{i&&(n=i(n,s)),r(e,o,n,s);let a=F(n.bidderRequests),d=v(e,n,a,o,s);t(d,a,n.auctionId,o,s)}catch(e){_(e),s.remoteAucError({code:l.ErrorCode.UNCAUGHT_ERROR,payload:{error:e}})}}catch(e){window.__pubx__.logger.error(e)}})})})(eI,eC,l.setSplitKeyGlobal,l.setFloorsAndMvInGlobal)})();